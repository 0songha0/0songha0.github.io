---
title: "Vue + SpringBoot í”„ë¡œì íŠ¸ ì†Œì¼“ í†µì‹  êµ¬í˜„ ë°©ë²•"
excerpt: ""

categories:
   - web-dev
tags:
  - []

permalink: /web-dev/2025-07-24-2

toc: true
toc_sticky: true
 
date: 2025-07-24
last_modified_at: 2025-07-24
---

## SpringBoot í”„ë¡œì íŠ¸ ì†Œì¼“ ì„œë²„ êµ¬í˜„

### ì›¹ì†Œì¼“ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€
```
dependencies {
  implementation 'com.corundumstudio.socketio:netty-socketio:2.0.12'
}
```
build.gradle íŒŒì¼ì— netty ì†Œì¼“ IO ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.

### Vue URL, ì†Œì¼“ ì„œë²„ URL ì„¤ì •
```
// í†°ìº£ ì„œë²„ í¬íŠ¸ ì„¤ì • (HTTP í†µì‹ ìš©)
server:
  port: 8088
  error:
    whitelabel:
      enabled: false
    include-exception: false
    include-stacktrace: never
    include-message: never
    path: "/custom-error"

// í†µì‹ ì„ ì£¼ê³ ë°›ì„ Vue URL ì„¤ì •
vue-port: "http://10.10.1.87:8082"

// netty ì†Œì¼“ ì„œë²„ í¬íŠ¸ ì„¤ì • (ì›¹ì†Œì¼“ í†µì‹ ìš©)
socket:
  io:
    server: 0.0.0.0 // ëª¨ë“  IPì—ì„œ ì˜¤ëŠ” ìš”ì²­ ìˆ˜ì‹  ëŒ€ê¸°
    port: 8084 // ë‹¤ë¥¸ ì„œë¹„ìŠ¤ì™€ ê°™ì€ í¬íŠ¸ ì‚¬ìš© ì‹œ ì¶©ëŒ ì—ëŸ¬ ë°œìƒ
```
application-ì„œë²„êµ¬ë¶„.yml íŒŒì¼ì— ì†Œì¼“ ì„œë²„ í¬íŠ¸, í†µì‹ ì„ ì£¼ê³ ë°›ì„ Vue URL, ì†Œì¼“ í¬íŠ¸ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.

### netty ì›¹ì†Œì¼“ ì„œë²„ ìƒì„±
```
package kr.co.rtboardsocketkafka.socket.config;

import com.corundumstudio.socketio.SocketIOServer;
import com.corundumstudio.socketio.Transport;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
public class SocketIOConfig {

  @Value("${socket.io.server}")
  private String server;
  @Value("${socket.io.port}")
  private int port;
  @Value("${vue-port}")
  private String vuePort;

  @Bean
  public SocketIOServer socketIOServer() {
    com.corundumstudio.socketio.Configuration config = new com.corundumstudio.socketio.Configuration();
    config.setHostname(server);
    config.setPort(port);
    config.setMaxFramePayloadLength(1024 * 1024);  // 1MBë¡œ ì„¤ì • ì˜ˆì‹œ
    config.setEnableCors(true);
    config.setAllowCustomRequests(true);
    config.setOrigin("*"); // CORS ì„¤ì • : ìš´ì˜ í™˜ê²½ì—ì„œëŠ” ìš´ì˜ ë„ë©”ì¸ ì§€ì • í•„ìš”
    config.setTransports(Transport.WEBSOCKET, Transport.POLLING);
    SocketIOServer server = new SocketIOServer(config);
    return server;
  }
}
```
SocketIOConfigë¥¼ Beanìœ¼ë¡œ ë“±ë¡í•˜ì—¬, í†°ìº£ ì„œë²„ì™€ ë³„ë„ë¡œ ì‹¤í–‰ë˜ëŠ” Netty ì›¹ì†Œì¼“ ì„œë²„ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

### ì†Œì¼“ ìë™ ì‹¤í–‰ ë° ì¢…ë£Œ ì²˜ë¦¬
```
package kr.co.rtboardsocketkafka.socket.lifeCycle;

import com.corundumstudio.socketio.SocketIOServer;
import jakarta.annotation.PostConstruct;
import jakarta.annotation.PreDestroy;
import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.stereotype.Component;

@Component
@Slf4j
@RequiredArgsConstructor
public class SocketIOServerLifeCycle {

  private final SocketIOServer server;

  private boolean isServerRunning = false;

  @PostConstruct
  public void start(){
    if (!isServerRunning) {
      server.start();
      isServerRunning = true;
      log.info("ì†Œì¼“ ì„œë²„ ì‹œì‘ {}", server.getConfiguration().toString());
      return;
    }
    log.info("ì´ë¯¸ ì‹œì‘ì¤‘ {}", server.getConfiguration().toString());
  }

  @PreDestroy
public void stop(){
    server.stop();
    log.info("ì†Œì¼“ ì„œë²„ DIE");
  }
}
```
@PostConstruct, @PreDestroy ì–´ë…¸í…Œì´ì…˜ì„ ì´ìš©í•˜ì—¬ ìŠ¤í”„ë§ë¶€íŠ¸ ì‹œì‘ ë° ì¢…ë£Œ ì‹œ ì†Œì¼“ì´ ìë™ ì‹œì‘ ë° ì¢…ë£Œë˜ë„ë¡ ì„¤ì •í•©ë‹ˆë‹¤.

---

## Vue í”„ë¡œì íŠ¸ ì†Œì¼“ ì—°ê²°

### ì†Œì¼“ ì„œë²„ URL í™˜ê²½ë³€ìˆ˜ ì„¤ì •
```
VITE_SOCKET_URL=http://10.10.1.87:8084
```
.env.ì„œë²„êµ¬ë¶„ íŒŒì¼ì— SpringBoot ì†Œì¼“ ì„œë²„ URLì„ ì‘ì„±í•©ë‹ˆë‹¤.  
ë°±ì—”ë“œ ì„œë²„ application-ì„œë²„êµ¬ë¶„.yml íŒŒì¼ì— socket io ì •ë³´ë¡œ ì‘ì„±ëœ í¬íŠ¸ì™€ ë™ì¼í•´ì•¼ í†µì‹ ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

---

## ë°±ì—”ë“œ í”„ë¡œì íŠ¸ì—ì„œ ì†Œì¼“ í†°ìº£ ì„œë²„ ìš”ì²­

Vue í”„ë¡œì íŠ¸ì˜ ë°±ì—”ë“œ í”„ë¡œì íŠ¸ì¸ SpringBoot í”„ë¡œì íŠ¸ì—ì„œ ì†Œì¼“ í”„ë¡œì íŠ¸ì— HTTP ìš”ì²­í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### application-ì„œë²„êµ¬ë¶„.yml ì„¤ì •
```
customSocket:
  server: "http://10.10.1.87:8088"
```
ìœ„ì™€ ê°™ì´, ì†Œì¼“ í¬íŠ¸ê°€ ì•„ë‹Œ ì†Œì¼“ í”„ë¡œì íŠ¸ í¬íŠ¸ë¥¼ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤.  
ì›¹ì†Œì¼“ í†µì‹ ì´ ì•„ë‹ˆë¼ HTTP í†µì‹ ì„ í•˜ê¸° ìœ„í•¨ì…ë‹ˆë‹¤.

### ì›¹ì†Œì¼“ ì„œë²„ ìš”ì²­ ì½”ë“œ
```
package kr.co.chunjae.backend.service;

import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.ObjectMapper;
import kr.co.chunjae.backend.dto.*;
import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Service;

import java.io.IOException;
import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;
import java.nio.charset.StandardCharsets;

@Service
@RequiredArgsConstructor
@Slf4j
public class ClassroomService {

  private final HttpClient httpClient = HttpClient.newHttpClient();
  private final ObjectMapper objectMapper = new ObjectMapper();

  @Value("${customSocket.server}")
  private String socketServer;

  public boolean sendSocketServer(User userInfo) {

    try {
      String jsonBody = objectMapper.writeValueAsString(userInfo);

      HttpRequest request = HttpRequest.newBuilder()
            .uri(URI.create(socketServer+"/socket/join"))
            .POST(HttpRequest
                  .BodyPublishers
                  .ofString(jsonBody, StandardCharsets.UTF_8))
            .header("Content-Type", "application/json")  // ğŸ“Œ Content-Type ì¶”ê°€
            .build();
      log.info("ë³´ë‚¸ uri {}",request);
      
      // ë™ê¸° ë°©ì‹ìœ¼ë¡œ ë³€ê²½
      HttpResponse<String> response = httpClient.send(request, HttpResponse.BodyHandlers.ofString());

      int statusCode = response.statusCode();
      if (statusCode == 200) {
        return true;
      } else {
        log.error("ì„œë²„ ì‘ë‹µ ì‹¤íŒ¨, ìƒíƒœ ì½”ë“œ: {}", statusCode);
        return false;
      }

    } catch (JsonProcessingException jpe) {
      log.error("ì›¹ì†Œì¼“ ì„œë²„ë¡œ ë³´ë‚´ê¸° ì „ User ê°ì²´ JSON ì§ë ¬í™” ì‹¤íŒ¨");
    } catch (IOException ioe) {
      log.error("ì›¹ì†Œì¼“ ì„œë²„ë¡œ ë³´ë‚´ê¸° ì „ ì›¹ì†Œì¼“ ì„œë²„ í†µì‹  ì¤‘ ì…ì¶œë ¥ ì˜¤ë¥˜ ë°œìƒ");
    } catch (InterruptedException ie) {
      Thread.currentThread().interrupt(); // ì¸í„°ëŸ½íŠ¸ í”Œë˜ê·¸ ë³µì›
      log.error("ì›¹ì†Œì¼“ ì„œë²„ë¡œ ë³´ë‚´ê¸° ì „ ì›¹ì†Œì¼“ ì„œë²„ í†µì‹  ì¤‘ ì¸í„°ëŸ½íŠ¸ ë°œìƒ");
    } catch (RuntimeException re) {
      log.error("ì›¹ì†Œì¼“ ì„œë²„ë¡œ ë³´ë‚´ê¸° ì „ ì›¹ì†Œì¼“ í†µì‹  ì¤‘ ì˜ˆê¸°ì¹˜ ëª»í•œ ì˜¤ë¥˜ ë°œìƒ");
    }
    return false;
  }
}
```
ìœ„ì™€ ê°™ì´, ì›¹ì†Œì¼“ ì„œë²„ì— HttpRequestë¥¼ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì›¹ì†Œì¼“ ì„œë²„ ìš”ì²­ ì˜ˆì‹œ
```
private final ClassroomService classroomService;

boolean isOK = classroomService.sendSocketServer(userInfo);
```
ì›¹ì†Œì¼“ ì„œë²„ì— URL í˜¸ì¶œí•˜ëŠ” ì„œë¹„ìŠ¤ ì‚¬ìš© ì˜ˆì‹œì…ë‹ˆë‹¤.
