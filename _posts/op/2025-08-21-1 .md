---
title: "리눅스 Nginx 서버 구축 및 Vue 프로젝트 빌드 방법"
excerpt: ""

categories:
  - op
tags:
  - []

permalink: /op/2025-08-21-1

toc: true
toc_sticky: true

date: 2025-08-21
last_modified_at: 2025-08-21
---

<mark>리눅스 Nginx 설치 시 참고</mark>  
<https://nginx.org/en/linux_packages.html>{: tatget="_blank"}  
Nginx 공식 홈페이지에서 리눅스 OS 종류별로 설치 방법을 자세히 알려주고 있습니다.

---

## 우분투 Nginx 서버 설치 방법 (인터넷O)

인터넷이 가능한 서버에서만 가능한 방법입니다.

### Nginx 저장소 필수 패키지 설치
```
sudo apt install curl gnupg ca-certificates lsb-release ubuntu-keyring
```
nginx 저장소 추가 시 필요한 필수 패키지들을 다운로드하여 준비합니다.

### Nginx 공식 서명 키 등록
```
curl https://nginx.org/keys/nginx_signing.key | gpg --dearmor \
    | sudo tee /usr/share/keyrings/nginx-archive-keyring.gpg >/dev/null
```
Nginx 패키지가 공식 저장소 nginx.org에서 서명한 것인지 검증하기 위해 GPG 서명 키를 다운로드해서 저장합니다.  
GPG 키를 등록하지 않으면, apt가 보안상 믿을 수 없다고 설치를 거부하게 됩니다.

### GPG 서명 키 검증
```
gpg --dry-run --quiet --no-keyring --import --import-options import-show /usr/share/keyrings/nginx-archive-keyring.gpg
```
방금 받은 서명 키가 nginx.org에서 제공한 키인지 확인합니다.
```
573BFD6B3D8FBC641079A6ABABF5BD827BD9BF62
```
위와 같은 출력이 포함되면 정상 키입니다.

### Nginx 공식 저장소 추가
<mark>Stable 버전 추가 명령어</mark>
```
echo "deb [signed-by=/usr/share/keyrings/nginx-archive-keyring.gpg] \
http://nginx.org/packages/ubuntu `lsb_release -cs` nginx" \
    | sudo tee /etc/apt/sources.list.d/nginx.list
```
최신이 아닐 수 있지만, 안정적인 버전의 Nginx 저장소를 추가합니다.

<mark>Mainline 버전 추가 명령어</mark>
```
echo "deb [signed-by=/usr/share/keyrings/nginx-archive-keyring.gpg] \
http://nginx.org/packages/mainline/ubuntu `lsb_release -cs` nginx" \
    | sudo tee /etc/apt/sources.list.d/nginx.list
```
실험적일 수 있지만, 최신 버전의 Nginx 저장소를 추가합니다.

### Pinning 설정
```
echo -e "Package: *\nPin: origin nginx.org\nPin: release o=nginx\nPin-Priority: 900\n" \
    | sudo tee /etc/apt/preferences.d/99nginx
```
Ubuntu 기본 저장소에 있는 Nginx가 아니라, nginx.org 저장소에서 받은 패키지를 우선 설치하도록 설정합니다.

### NginX 설치
```
sudo apt update
sudo apt install nginx
```
apt update 명령어로 추가된 저장소 목록을 최신화 후, Nginx를 설치합니다.

---

## 우분투 Nginx 서버 설치 방법 (인터넷X)

인터넷 연결이 불가한 운영서버에서 Nginx를 설치하는 방법입니다.

### Nginx 설치 패키지 파일 다운로드
<https://nginx.org/packages/ubuntu/pool/nginx/n/nginx>{: target="_blank"}  
위 링크에서 리눅스 OS 버전 및 CPU 종류에 맞는 Nginx 설치 패키지 파일을 다운로드 합니다.  
nginx-dbg 파일은 개발 및 디버깅용이므로, nginx_1.28.0-1~noble_amd64.deb 같은 파일을 받아야 합니다.

### Nginx 설치
```
cd /deb파일위치
sudo apt install ./nginx_1.28.0-1~noble_amd64.deb
```
윈도우에서 다운받은 Nginx 설치 패키지 deb 파일을 파일질라로 서버에 올리고 설치합니다.  
dpkg -i 명령어와 달리, apt i 명령어는 .deb 파일 의존성도 자동으로 설치됩니다.

<mark>파일 접근 권한 관련 에러 메시지</mark>
```
N: Download is performed unsandboxed as root as file '/home/ncloud/insatall/nginx_1.28.0-1~noble_amd64.deb' couldn't be accessed by user '_apt'. - pkgAcquire::Run (13: Permission denied)
```
위와 같은 에러가 발생해도 Nginx 설치 및 동작에는 영향이 없으므로 무시해도 됩니다.

### Nginx 설치 확인
```
nginx -v
또는
sudo systemctl status nginx
```
nginx 설치가 정상적으로 되었는지 확인할 수 있습니다.

---

## Nginx 서버 실행 및 종료

### Nginx 서버 실행
```
systemctl start nginx
```

<mark>Nginx 실행파일 위치 확인</mark>
```
which nginx
```
일반적으로 /usr/sbin/nginx 폴더에 nginx 실행파일이 저장됩니다.

### Nginx 서버 종료
```
systemctl stop nginx
```

### Nginx 서버 자동시작 설정
```
systemctl enable nginx
```

<mark>Nginx 서버 자동시작 여부 확인</mark>
```
systemctl is-enabled nginx
```
enable라고 나오면 리눅스 서버 재기동 시 Nginx 서버도 자동시작됩니다.

---

## Nginx 서버 설정

### Nginx 설정파일 종류
<table class="table_2_left">
  <tbody>
    <tr>
      <td>/etc/nginx/nginx.conf</td>
      <td>Nginx 메인 설정 파일</td>
    </tr>
    <tr>
      <td>/etc/nginx/conf.d/*.conf</td>
      <td>
        공통 설정 또는 개별 사이트 설정 파일<br>
        Ubuntu 보다는 CentOS 계열에서 주로 사용합니다.
      </td>
    </tr>
    <tr>
      <td>/etc/nginx/sites-available/도메인명</td>
      <td>사이트별 가상호스트 설정 파일 (원본)</td>
    </tr>
    <tr>
      <td>/etc/nginx/sites-enabled/도메인명</td>
      <td>
        활성화된 사이트 설정 파일 (심볼릭 링크)<br>
        Nginx가 실제로 참조하는 파일입니다.
        </td>
    </tr>
  </tbody>
</table>
Ubuntu 계열 Nginx 디렉토리 구조입니다.

### 웹 루트 폴더 변경
Nginx 기본 웹 루트 폴더 /var/www/html는 다른 폴더로 변경이 가능합니다.  
Nginx 설정 파일에서 'root /var/www/프로젝트명_current'으로 수정하면 됩니다.

---

## Vue 프로젝트 배포 방법

### Vue 프로젝트 빌드 명령어
```
npm run build --mode 프로파일명
```
프로젝트 빌드 시 .vue 파일들이 정적 HTML, JS, CSS 파일로 변환되어 dist 폴더에 생성됩니다.  
mode 옵션은 빌드 시 사용할 환경변수 .env 파일을 지정하는 용도입니다.  
mode를 지정하지 않으면 production 모드로 자동 설정됩니다.

### dist 폴더 압축 후 서버 업로드
로컬에서 dist 폴더 압축 후 파일질라로 리눅스 서버에 올립니다.

### dist 폴더 압축 해제
```
unzip /업로드경로/dist.zip -d /var/www/프로젝트명_v버전명
```
위 명령어로 압축을 해제하여 신규 배포 폴더를 생성합니다.  
-d 옵션으로 지정한 폴더가 없으면 자동 생성됩니다.

### 심볼릭 링크 생성 및 교체
```
ln -sfn /var/www/프로젝트명_v버전명 /var/www/프로젝트명_current
```
웹 루트 폴더로 접근하면 실제 파일이 있는 폴더로 연결되는 심볼릭 링크를 생성합니다.  
fn 옵션으로 인해 같은 이름의 심볼릭링크가 있으면 덮어쓰기 됩니다.  

### Nginx 설정 재적용 및 워커 재로드
```
sudo nginx -s reload
```
Nginx는 웹 루트로 설정된 심볼릭 링크 경로를 계속 참조하므로, Nginx 재시작 없이도 신규 소스가 반영됩니다.  
그러나, Nginx 워커가 이미 열고 있는 파일도 최신 파일로 반영하려면 reload 하는 것이 좋습니다.  
Nginx 마스터 프로세스가 설정 파일을 다시 읽고, 새로운 워커 프로세스가 띄워집니다.  
기존 워커가 기존 연결을 모두 처리한 뒤 종료되므로 사용자 접속 끊김이 거의 없는 방식입니다.

### 기존 배포 폴더 삭제
```
cd /var/www
rm -rf 프로젝트명_v기존버전명
```
신규 배포 후 안정화 기간이 지나도 문제가 없는 경우, 기존 배포 폴더는 삭제하는 것이 권장됩니다.
